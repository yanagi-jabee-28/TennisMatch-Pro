// テストシナリオ手順書

## 問題の再現手順

### 1. 初期設定
1. ブラウザでアプリケーションを開く (http://localhost:8080)
2. デバッグボタン「🎲 デバッグ: ランダムスコア生成」をクリック
3. 確認ダイアログで「はい」を選択
4. 「🔍 統計計算検証」ボタンをクリックして初期状態を確認

### 2. 問題の再現
1. チーム4の編集ボタン（鉛筆アイコン）をクリック
2. 「チーム参加状態」トグルボタンをクリックしてチーム4を不参加にする
3. 「🔍 統計計算検証」ボタンをクリックして統計を確認
4. 順位表で各チームの試合数を確認

### 3. 期待される結果
- チーム1、2、3: それぞれ2試合ずつ（1vs2, 1vs3, 2vs3）
- チーム4: 順位表に表示されない（不参加のため）

### 4. 実際の問題（以前発生していた）
- 一部のチームで3勝2敗1分（計6試合）のような不正な統計が表示される
- 引き分けが不適切に発生する

### 5. 検証ポイント
1. 各チームの試合数が正しいか
2. 勝敗の合計が論理的に正しいか
3. 引き分けが適切に計算されているか
4. チーム4の試合データが完全に削除されているか

## デバッグ出力の確認項目

コンソールで以下を確認：
- 参加中のチーム数
- 有効な試合数（3チーム = 3試合であるべき）
- 各チームの試合数（2試合であるべき）
- 勝敗の論理的整合性

## 修正前後の比較

### 修正前の問題
1. `getDirectMatchResult`でmatches.filter()がエラー
2. `teamStats`の変換でteamIdが正しくマッピングされない
3. 不参加チームの試合データが残存

### 修正後の期待動作
1. Object.values(matches).filter()で正常動作
2. Object.entries(teamStats).map()で正しいID割り当て
3. 不参加時に関連試合データを自動削除
