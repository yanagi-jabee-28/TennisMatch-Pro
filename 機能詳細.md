# テニス試合管理アプリ - 機能詳細書

## 概要
硬式テニスの試合管理を効率的に行うためのWebアプリケーションです。
チーム編成、試合結果の記録、順位表の自動生成などの機能を提供します。

---

## 主要機能

### 1. チーム管理機能

#### 1.1 基本チーム情報
- **チーム数**: 5チーム（チーム1～5）
- **欠席チーム**: チーム6として独立管理
- **初期メンバー構成**: 各チーム3名ずつ（合計15名）

#### 1.2 チーム編成機能
- **メンバー選択システム**: メンバーをクリックして選択状態にする
- **チームヘッダークリック割り当て**: 選択されたメンバーをチームヘッダーをクリックして割り当て
- **ドラッグ&ドロップ非対応**: シンプルなクリック操作のみ
- **リアルタイム更新**: チーム変更が即座にUIに反映

#### 1.3 メンバー管理
- **未割り当てメンバー表示**: どのチームにも所属していないメンバーを専用エリアに表示
- **欠席メンバー管理**: チーム6として統合管理、専用の復帰ボタン付き
- **メンバー移動**: チーム間での自由な移動が可能
- **重複防止**: 同一メンバーの複数チーム所属を自動防止

#### 1.4 チーム操作
- **個別チーム編集**: 各チームの「編集」ボタンからモーダルでメンバー編集
- **全チームリセット**: 「オリジナル構成に戻す」ボタンで初期状態に復元
- **全メンバー未割り当て**: 「全メンバーを未割り当てにする」ボタンですべてクリア
- **確認ダイアログなし**: スムーズな操作のため確認ダイアログを廃止

### 2. 試合管理機能

#### 2.1 対戦表システム
- **総当たり戦**: 5チーム間での全組み合わせ（10試合）
- **クリック入力**: 対戦表のマスをクリックしてスコア入力
- **リアルタイム更新**: 結果入力後即座に表示更新
- **結果修正**: 既存結果をクリックして再編集可能

#### 2.2 スコア管理
- **マッチポイント設定**: デフォルト7点、1-99点で調整可能
- **自動上限適用**: マッチポイントを超える入力を自動制限
- **勝敗判定**: スコア差による自動勝敗判定
- **引き分け対応**: 同点の場合は引き分けとして記録

#### 2.3 試合結果表示
- **色分け表示**: 勝利（緑）、敗北（赤）、引き分け（グレー）
- **スコア表示**: 「自チーム得点-相手チーム得点」形式
- **対称表示**: 対戦表の上下で同じ試合の結果が対称表示

### 3. 順位表機能

#### 3.1 自動順位計算
- **勝利数**: 勝った試合の数
- **敗北数**: 負けた試合の数  
- **引分数**: 引き分けた試合の数
- **得点**: 全試合での総得点
- **得失点差**: 得点から失点を引いた値
- **勝率**: 勝利数÷総試合数×100（%）

#### 3.2 順位決定ルール
1. **勝利数** - 多い順
2. **勝率** - 高い順
3. **得失点差** - 大きい順
4. **得点** - 多い順

#### 3.3 順位表表示
- **リアルタイム更新**: 試合結果入力と同時に順位更新
- **詳細統計**: 各チームの全統計を一覧表示
- **色分け**: 上位チームをハイライト表示

### 4. データ管理機能

#### 4.1 ローカルストレージ
- **自動保存**: すべての変更を自動的にブラウザに保存
- **データ永続化**: ページリロード後もデータを維持
- **複数データ管理**: チーム構成、試合結果、設定を個別管理

#### 4.2 エクスポート機能
- **CSV出力**: 試合分析データをCSV形式でダウンロード
- **詳細データ**: 試合結果、順位、統計データを包含
- **ファイル名自動生成**: 日時付きファイル名で自動生成

#### 4.3 データリセット
- **試合結果クリア**: 全試合結果のみを削除
- **チームリセット**: チーム構成を初期状態に戻す
- **設定保持**: マッチポイント等の設定は保持

### 5. ユーザーインターフェース

#### 5.1 メンバー選択システム
- **視覚的選択**: 選択されたメンバーは背景色変更で表示
- **選択パレット**: 選択されたメンバーを一覧表示する専用パネル
- **バッチ操作**: 複数メンバーの同時選択・割り当てが可能
- **直感的操作**: チームヘッダークリックで即座に割り当て

#### 5.2 レスポンシブデザイン
- **モバイル対応**: スマートフォンでも使いやすいレイアウト
- **タブレット最適化**: タッチ操作に適したボタンサイズ
- **デスクトップ対応**: 大画面での効率的な表示

#### 5.3 操作フィードバック
- **トースト通知**: 重要な操作完了時に一時的な通知表示
- **ホバー効果**: マウスオーバー時の視覚的フィードバック
- **状態表示**: チームヘッダーの割り当て可能状態を色で表示

### 6. 設定機能

#### 6.1 試合設定
- **マッチポイント**: 1-99点の範囲で設定可能
- **ヘッダー表示**: 設定項目をヘッダーに常時表示
- **即座反映**: 設定変更が即座に適用

#### 6.2 デバッグ機能
- **ランダムスコア生成**: テスト用のランダム試合結果生成
- **開発者向け**: アプリケーション動作確認用

---

## 技術仕様

### 使用技術
- **フロントエンド**: HTML5, CSS3, JavaScript (ES6+)
- **モジュール構成**: ES6 Modules使用
- **データ永続化**: LocalStorage API
- **レスポンシブ**: CSS Grid, Flexbox

### ファイル構成
```
/
├── index.html              # メインHTMLファイル
├── css/
│   ├── styles.css         # メインスタイル
│   ├── base.css           # 基本スタイル
│   ├── layout.css         # レイアウト
│   ├── responsive.css     # レスポンシブ対応
│   └── components/        # コンポーネント別CSS
├── app/
│   ├── main.js           # アプリケーション初期化
│   ├── state.js          # 状態管理
│   ├── matches.js        # 試合・チーム管理
│   ├── standings.js      # 順位表管理
│   ├── dom.js            # DOM要素キャッシュ
│   ├── utils.js          # ユーティリティ関数
│   ├── export.js         # データエクスポート
│   ├── debug.js          # デバッグ機能
│   └── components/       # UIコンポーネント
```

### データ構造
```javascript
// アプリケーション状態
appState = {
  teams: [                    // 通常チーム(1-5)
    { id: 1, members: [...] },
    { id: 2, members: [...] },
    ...
  ],
  absentTeam: {              // 欠席チーム(6)
    id: 6,
    members: [...]
  },
  originalTeams: [...],      // 初期チーム構成
  matches: {                 // 試合結果
    "1vs2": {
      team1: 1, team2: 2,
      scoreTeam1: 7, scoreTeam2: 5,
      winner: 1
    },
    ...
  },
  settings: {                // アプリ設定
    matchPoint: 7
  }
}
```

---

## 操作方法

### 基本的なワークフロー

#### 1. チーム編成
1. メンバーをクリックして選択（複数選択可能）
2. 割り当てたいチームのヘッダーをクリック
3. 選択が解除され、メンバーがチームに移動

#### 2. 欠席設定
1. 欠席にしたいメンバーをクリックして選択
2. 「欠席チーム（チーム6）」のヘッダーをクリック
3. メンバーが欠席チームに移動

#### 3. 試合結果入力
1. 対戦表の該当マスをクリック
2. モーダルで各チームのスコアを入力
3. 「保存」ボタンで結果を記録

#### 4. チーム編集（詳細）
1. 各チームの「編集」ボタンをクリック
2. モーダルでメンバーの追加・削除
3. 「保存」ボタンで変更を確定

### ショートカット操作
- **全選択解除**: 選択パレットの「選択をクリア」ボタン
- **全チームリセット**: 「オリジナル構成に戻す」ボタン
- **全未割り当て**: 「全メンバーを未割り当てにする」ボタン

---

## バージョン履歴

### v2.0.0 (2025/06/06)
- 欠席システムをチーム6として統合
- チームヘッダークリック機能を追加
- 確認ダイアログを削除してUX改善
- メンバー選択システムを導入
- パレットUI を刷新

### v1.0.0 (初期版)
- 基本的なチーム管理機能
- 試合結果入力・管理
- 順位表自動生成
- データ永続化機能

---

## 今後の拡張予定
- チーム数の可変対応
- トーナメント形式への対応
- 詳細な統計分析機能
- データインポート機能
- 印刷用レイアウト
